<!DOCTYPE html>
<html lang="mr">
<head>
  <meta charset="UTF-8">
  <title>दूध ऑर्डर फॉर्म</title>
  <link href="https://fonts.googleapis.com/css2?family=Baloo+2:wght@700&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f8f8f8;
      margin: 0;
      padding: 0;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
    }
    .container {
      background: #ffffff;
      padding: 30px 40px;
      border-radius: 12px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
      width: 360px;
    }
    h2 { text-align: center; color: #d35400; font-family: 'Baloo 2', cursive; font-size: 28px; font-weight: 700; margin-bottom: 5px; }
    h3 { text-align: center; color: #2c3e50; font-size: 18px; margin-bottom: 20px; }
    .notification { display: none; text-align: center; padding: 10px; border-radius: 6px; margin-bottom: 15px; font-weight: bold; }
    .success { background-color: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
    .error { background-color: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
    label { font-weight: bold; display: block; margin-top: 15px; color: #34495e; }
    input, select, button { width: 100%; padding: 10px; margin-top: 5px; border-radius: 6px; border: 1px solid #ccc; box-sizing: border-box; font-size: 14px; }
    .bill { margin-top: 10px; font-weight: bold; color: #e67e22; }
    .stock { margin-top: 10px; font-weight: bold; color: #2980b9; text-align: center; }
    button { background-color: #27ae60; color: white; border: none; cursor: pointer; margin-top: 20px; font-weight: bold; transition: 0.3s; }
    button:hover { background-color: #2ecc71; }
    .cancel-button { background-color: #e74c3c; }
    .cancel-button:hover { background-color: #ff5c5c; }
    .button-group { display: flex; justify-content: space-between; gap: 10px; }
  </style>
</head>
<body>
<div class="container">
  <h2>सावरिया डेअरी फार्म, कोंढावळ</h2>
  <h3>दूध ऑर्डर फॉर्म</h3>

  <div id="notification" class="notification"></div>

  <div class="stock" id="stockInfo">सकाळ Stock: 10 लीटर | संध्याकाळ Stock: 10 लीटर</div>

  <form id="orderForm">
    <label>तारीख:</label>
    <input type="date" id="date">

    <label>नाव:</label>
    <input type="text" id="customerName" placeholder="आपले नाव टाका">

    <label>गाव:</label>
    <select id="village">
      <option value="कोंढावळ">कोंढावळ</option>
      <option value="वडाळी">वडाळी</option>
    </select>

    <label>दूधाचा प्रकार:</label>
    <select id="milkType">
      <option value="म्हैस">म्हैस</option>
    </select>

    <label>प्रमाण (जास्तीत जास्त 3 लीटर):</label>
    <input type="number" id="quantity" min="0.5" max="3" step="0.5" placeholder="0.5 ते 3 लीटर" oninput="calculateBill()">

    <div class="bill" id="totalBill">एकूण बिल: ₹0</div>

    <label>वेळ:</label>
    <select id="time">
      <option value="सकाळ">सकाळ</option>
      <option value="संध्याकाळ">संध्याकाळ</option>
    </select>

    <label>आपला संपर्क नंबर:</label>
    <input type="text" id="contactNumber" placeholder="आपला नंबर प्रविष्ट करा">

    <div class="button-group">
      <button type="button" onclick="sendSMS()">Submit</button>
      <button type="button" class="cancel-button" onclick="cancelForm()">रद्द करा</button>
    </div>
  </form>
</div>

<script>
const farmNumber = "8605650394";
const ratePerLiter = 80;
const maxPerUser = 3;

let morningStock = 10;
let eveningStock = 10;
let lastDate = null;

function showNotification(message, type) {
  const notification = document.getElementById("notification");
  notification.innerText = message;
  notification.className = "notification " + type;
  notification.style.display = "block";
  setTimeout(() => { notification.style.display = "none"; }, 4000);
}

function updateStockInfo() {
  document.getElementById("stockInfo").innerText = `सकाळ Stock: ${morningStock} लीटर | संध्याकाळ Stock: ${eveningStock} लीटर`;
}

function updateTimeOptions() {
  const timeSelect = document.getElementById("time");
  timeSelect.querySelector('option[value="सकाळ"]').disabled = (morningStock <= 0);
  timeSelect.querySelector('option[value="संध्याकाळ"]').disabled = (eveningStock <= 0);
  if (timeSelect.value === "सकाळ" && morningStock <= 0) timeSelect.value = (eveningStock>0)?"संध्याकाळ":"";
  if (timeSelect.value === "संध्याकाळ" && eveningStock <= 0) timeSelect.value = (morningStock>0)?"सकाळ":"";
}

function resetStockIfNewDay() {
  const today = document.getElementById("date").value;
  if (lastDate !== today) {
    morningStock = 10;
    eveningStock = 10;
    lastDate = today;
    updateStockInfo();
    updateTimeOptions();
  }
}

function calculateBill() {
  resetStockIfNewDay();
  let quantity = parseFloat(document.getElementById("quantity").value);
  if (!quantity || quantity < 0.5) quantity = 0;
  if (quantity > maxPerUser) {
    showNotification(`प्रत्येक युजरला जास्तीत जास्त ${maxPerUser} लीटर ऑर्डर करता येईल.`, "error");
    document.getElementById("quantity").value = "";
    document.getElementById("totalBill").innerText = "एकूण बिल: ₹0";
    return;
  }
  document.getElementById("totalBill").innerText = `एकूण बिल: ₹${quantity*ratePerLiter}`;
  updateTimeOptions();
}

function sendSMS() {
  resetStockIfNewDay();

  let date = document.getElementById("date").value;
  let name = document.getElementById("customerName").value;
  let village = document.getElementById("village").value;
  let milkType = document.getElementById("milkType").value;
  let quantity = parseFloat(document.getElementById("quantity").value);
  let time = document.getElementById("time").value;
  let contactNumber = document.getElementById("contactNumber").value;

  if (!date || !name || !village || !milkType || !quantity || !time || !contactNumber) {
    showNotification("कृपया सर्व तपशील भरा!", "error");
    return;
  }

  if (quantity > maxPerUser) {
    showNotification(`प्रत्येक युजरला जास्तीत जास्त ${maxPerUser} लीटर ऑर्डर करता येईल.`, "error");
    return;
  }
  if (quantity < 0.5) {
    showNotification("कृपया किमान 0.5 लीटर टाका.", "error");
    return;
  }

  if (time === "सकाळ") {
    if (quantity > morningStock) { showNotification("क्षमस्व! सकाळचा स्टॉक संपला आहे.", "error"); return; }
    morningStock -= quantity;
  } else if (time === "संध्याकाळ") {
    if (quantity > eveningStock) { showNotification("क्षमस्व! संध्याकाळचा स्टॉक संपला आहे.", "error"); return; }
    eveningStock -= quantity;
  }

  let totalBill = quantity * ratePerLiter;
  let message = `सावरिया डेअरी फार्म, कोंढावळ\nदूध ऑर्डर तपशील\n\n` +
                `- तारीख: ${date}\n- नाव: ${name}\n- गाव: ${village}\n- दूधाचा प्रकार: ${milkType}\n` +
                `- प्रमाण: ${quantity} लीटर\n- वेळ: ${time}\n- संपर्क: ${contactNumber}\n- एकूण बिल: ₹${totalBill}`;

  window.open("sms:"+farmNumber+"?body="+encodeURIComponent(message), "_blank");
  showNotification("ऑर्डर यशस्वीरीत्या सबमिट झाली ✅", "success");

  updateStockInfo();
  updateTimeOptions();
  document.getElementById("orderForm").reset();
  document.getElementById("totalBill").innerText = "एकूण बिल: ₹0";
}

function cancelForm() {
  document.getElementById("orderForm").reset();
  document.getElementById("totalBill").innerText = "एकूण बिल: ₹0";
  updateTimeOptions();
}
</script>
</body>
</html>